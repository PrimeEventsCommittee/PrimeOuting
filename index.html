<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="Join us for an unforgettable team outing experience to the beautiful hills of Dehradun. Prime Outing 2025 is designed to strengthen team bonds, create lasting memories, and provide the perfect break from work routine.">
    <meta name="author" content="Prime Events Committee">
    <meta name="keywords" content="Prime Outing 2025, team outing, Dehradun, team building, corporate event, hills, adventure">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#EE5007">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Prime Outing 2025">
    <meta name="msapplication-TileImage" content="images/icon-144x144.png">
    <meta name="msapplication-TileColor" content="#F8CB2E">
    
    <!-- Android specific meta tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Prime Outing 2025">
    
    <!-- Chrome for Android -->
    <meta name="theme-color" content="#EE5007">
    <meta name="color-scheme" content="light">
    
    <!-- Android Chrome install banner -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

    <!-- Manifest -->
    <link rel="manifest" href="./manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="48x48" href="./images/icon-48x48.png">
    <link rel="icon" type="image/png" sizes="144x144" href="./images/icon-144x144.png">
    <link rel="icon" type="image/png" sizes="192x192" href="./images/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="./images/icon-512x512.png">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="./images/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="192x192" href="./images/icon-192x192.png">
    
    <!-- Android Chrome -->
    <link rel="icon" sizes="192x192" href="./images/icon-192x192.png">

    <title>Prime Outing 2025 - Official Website</title>

    <!-- CSS FILES -->
    <link rel="preconnect" href="https://fonts.googleapis.com">

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100;200;400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&family=Fredoka+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link href="css/bootstrap.min.css" rel="stylesheet">

    <link href="css/bootstrap-icons.css" rel="stylesheet">

    <link href="css/templatemo-festava-live.css" rel="stylesheet">
    
    <!-- Custom Photo Album Styles -->
    <style>
        /* Smooth scrolling for the entire page */
        html {
            scroll-behavior: smooth;
        }
        
        /* Scroll offset for navigation sections - reduced for relative navbar */
        section[id] {
            scroll-margin-top: 20px;
        }
        
        /* Alternative method for better browser support */
        #section_2::before,
        #section_3::before,
        #section_4::before,
        #section_5::before,
        #section_6::before {
            content: '';
            display: block;
            height: 20px;
            margin-top: -20px;
            visibility: hidden;
        }
        
        /* Set navbar to dark charcoal background */
        .navbar {
            position: relative;
            background: #2c3e50 !important;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        /* Ensure navbar text is white for visibility */
        .navbar .navbar-brand,
        .navbar .nav-link {
            color: #ffffff !important;
        }
        
        .navbar .navbar-brand:hover,
        .navbar .nav-link:hover {
            color: #F8CB2E !important;
        }
        
        /* Optional: Add fixed navbar on scroll */
        .navbar.navbar-fixed {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(44, 62, 80, 0.95) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        /* Add top padding to body to account for fixed navbar */
        body {
            padding-top: 0;
        }
        
        /* Adjust hero section to account for navbar */
        .hero-section {
            margin-top: 0;
            padding-top: 0;
        }
        
        /* Gallery Section Styles */
        .gallery-section {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            position: relative;
            overflow: hidden;
        }
        
        .gallery-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="gallery-dots" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="rgba(248,203,46,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23gallery-dots)"/></svg>');
            opacity: 0.3;
        }
        
        .gallery-container {
            position: relative;
            z-index: 2;
        }
        
        .gallery-title {
            text-align: center;
            color: #F8CB2E;
            font-family: 'Fredoka One', cursive;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .gallery-subtitle {
            text-align: center;
            color: #ffffff;
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }
        
        /* Photo Album Styles */
        .album-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 280px;
            perspective: 1000px;
        }
        
        .closed-album {
            width: 320px;
            height: 240px;
            background: linear-gradient(135deg, #8B4513, #A0522D);
            border-radius: 10px;
            box-shadow: 
                0 0 0 8px #654321,
                0 0 0 12px #8B4513,
                0 15px 35px rgba(0,0,0,0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            pointer-events: auto;
            z-index: 10;
        }
        
        .closed-album:hover {
            transform: translateY(-10px) rotateX(5deg);
            box-shadow: 
                0 0 0 8px #654321,
                0 0 0 12px #8B4513,
                0 25px 50px rgba(0,0,0,0.5);
        }
        
        .album-cover {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #8B4513, #A0522D);
            border-radius: 8px;
        }
        
        .album-cover::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border: 2px solid #F8CB2E;
            border-radius: 5px;
            opacity: 0.7;
        }
        
        .album-cover-content {
            text-align: center;
            color: #F5F5DC;
            z-index: 1;
            position: relative;
        }
        
        .album-title {
            font-family: 'Fredoka One', cursive;
            font-size: 1.4rem;
            margin-bottom: 0.4rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .album-subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 1.2rem;
        }
        
        .click-to-open {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
            opacity: 0.8;
            animation: pulse 2s infinite;
        }
        
        .click-to-open i {
            font-size: 1.2rem;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        .album-spine {
            position: absolute;
            left: 0;
            top: 5%;
            bottom: 5%;
            width: 15px;
            background: linear-gradient(to bottom, #654321, #8B4513, #654321);
            border-radius: 0 3px 3px 0;
            box-shadow: inset -2px 0 5px rgba(0,0,0,0.3);
        }
        
        .album-spine::before {
            content: '';
            position: absolute;
            top: 20%;
            bottom: 20%;
            left: 3px;
            width: 2px;
            background: #F8CB2E;
            border-radius: 1px;
        }
        
        /* Flipbook Album Styles */
        .flipbook-album {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            min-height: 520px;
            animation: bookOpen 0.8s ease-out;
        }
        
        @keyframes bookOpen {
            from {
                opacity: 0;
                transform: scale(0.3);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .book-container {
            position: relative;
            width: 720px;
            height: 480px;
            perspective: 1500px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .book-left-page,
        .book-right-page {
            width: 320px;
            height: 440px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            transition: transform 0.1s ease;
            transform-style: preserve-3d;
        }
        
        .book-left-page {
            border-radius: 10px 0 0 10px;
            transform-origin: right center;
            margin-right: 5px;
        }
        
        .book-right-page {
            border-radius: 0 10px 10px 0;
            transform-origin: left center;
            margin-left: 5px;
        }
        
        .book-binding {
            position: absolute;
            width: 20px;
            height: 440px;
            background: linear-gradient(to right, #8B4513, #A0522D, #8B4513);
            left: 50%;
            transform: translateX(-50%);
            z-index: 5;
            border-radius: 3px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
        }
        
        .book-binding::before {
            content: '';
            position: absolute;
            top: 10%;
            bottom: 10%;
            left: 50%;
            width: 2px;
            background: #F8CB2E;
            transform: translateX(-50%);
        }
        
        .page-content {
            width: 100%;
            height: 100%;
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
        }
        
        .page-content img {
            max-width: 260px;
            max-height: 320px;
            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            margin-bottom: 12px;
        }
        
        .page-content h3 {
            color: #2c3e50;
            font-family: 'Fredoka One', cursive;
            font-size: 1.4rem;
            margin-bottom: 10px;
        }
        
        .page-content p {
            color: #34495e;
            font-size: 0.9rem;
            line-height: 1.4;
            margin: 0;
        }
        
        .book-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }
        
        .book-nav-btn {
            background: linear-gradient(135deg, #F8CB2E, #EE5007);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .book-nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(238, 80, 7, 0.3);
        }
        
        .book-nav-btn:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .close-book-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b) !important;
        }
        
        .close-book-btn:hover {
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3) !important;
        }
        
        .page-counter {
            color: #2c3e50;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            font-size: 1.1rem;
        }
        
        /* Page Flip Animation */
        .page-flip-left {
            animation: flipLeft 0.8s ease-in-out;
            transform-style: preserve-3d;
        }
        
        .page-flip-right {
            animation: flipRight 0.8s ease-in-out;
            transform-style: preserve-3d;
        }
        
        .page-flip-forward {
            animation: flipForward 0.8s ease-in-out;
            transform-style: preserve-3d;
        }
        
        .page-flip-backward {
            animation: flipBackward 0.8s ease-in-out;
            transform-style: preserve-3d;
        }
        
        @keyframes flipLeft {
            0% { 
                transform: rotateY(0deg);
                z-index: 2;
            }
            25% {
                transform: rotateY(-45deg);
                z-index: 3;
            }
            50% { 
                transform: rotateY(-90deg);
                z-index: 3;
            }
            75% {
                transform: rotateY(-135deg);
                z-index: 3;
            }
            100% { 
                transform: rotateY(-180deg);
                z-index: 1;
            }
        }
        
        @keyframes flipRight {
            0% { 
                transform: rotateY(0deg);
                z-index: 2;
            }
            25% {
                transform: rotateY(45deg);
                z-index: 3;
            }
            50% { 
                transform: rotateY(90deg);
                z-index: 3;
            }
            75% {
                transform: rotateY(135deg);
                z-index: 3;
            }
            100% { 
                transform: rotateY(180deg);
                z-index: 1;
            }
        }
        
        @keyframes flipForward {
            0% { 
                transform: rotateY(0deg);
                opacity: 1;
                z-index: 2;
            }
            25% {
                transform: rotateY(-45deg);
                z-index: 3;
            }
            50% { 
                transform: rotateY(-90deg);
                opacity: 0.8;
                z-index: 3;
            }
            51% {
                opacity: 0;
            }
            52% {
                opacity: 0.8;
            }
            75% {
                transform: rotateY(-135deg);
                z-index: 3;
            }
            100% { 
                transform: rotateY(-180deg);
                opacity: 1;
                z-index: 2;
            }
        }
        
        @keyframes flipBackward {
            0% { 
                transform: rotateY(0deg);
                opacity: 1;
                z-index: 2;
            }
            25% {
                transform: rotateY(45deg);
                z-index: 3;
            }
            50% { 
                transform: rotateY(90deg);
                opacity: 0.8;
                z-index: 3;
            }
            51% {
                opacity: 0;
            }
            52% {
                opacity: 0.8;
            }
            75% {
                transform: rotateY(135deg);
                z-index: 3;
            }
            100% { 
                transform: rotateY(180deg);
                opacity: 1;
                z-index: 2;
            }
        }
        
        /* Cover Page Styles */
        .cover-page {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
        }
        
        .cover-page h2 {
            font-family: 'Fredoka One', cursive;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #F8CB2E;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .cover-page p {
            font-size: 1.2rem;
            opacity: 0.9;
            color: white !important;
        }
        
        .decorative-border {
            width: 200px;
            height: 2px;
            background: #F8CB2E;
            margin: 20px auto;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .closed-album {
                width: 240px;
                height: 180px;
            }
            
            .album-title {
                font-size: 1.1rem;
            }
            
            .book-container {
                width: 100%;
                max-width: 500px;
                height: 350px;
            }
            
            .book-left-page,
            .book-right-page {
                width: 220px;
                height: 320px;
            }
            
            .page-content {
                padding: 15px;
            }
            
            .page-content img {
                max-width: 180px;
                max-height: 220px;
            }
            
            .book-controls {
                flex-wrap: wrap;
                justify-content: center;
                gap: 10px;
            }
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .closed-album {
                width: 300px;
                height: 220px;
            }
            
            .album-title {
                font-size: 1.4rem;
            }
            
            .album-viewer {
                width: 95vw;
                height: 90vh;
            }
            
            .photo-display {
                padding: 20px;
            }
            
            .photo-container img {
                max-height: 250px;
            }
            
            .photo-thumbnails {
                gap: 10px;
            }
            
            .thumbnail {
                width: 60px;
                height: 45px;
            }
            
            .navigation-controls {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>

    <!--

TemplateMo 583 Festava Live

https://templatemo.com/tm-583-festava-live

-->
</head>

<body>

    <main>

        <header class="site-header">
            <div class="container">
                <div class="row">

                    <div class="col-lg-12 col-12 d-flex flex-wrap">
                        <p class="d-flex me-4 mb-0">
                            <i class="bi-person custom-icon me-2"></i>
                            <strong class="text-dark">Welcome to Prime Outing 2025</strong>
                        </p>
                    </div>

                </div>
            </div>
        </header>


        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <a class="navbar-brand" href="index.html">
                    Prime Outing 2025
                </a>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav align-items-lg-center ms-auto me-lg-5">
                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_1">Home</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_2">About</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_3">Gallery</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_4">Location</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_5">Schedule</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link click-scroll" href="#section_6">Contact</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>


        <section class="hero-section" id="section_1">
            <div class="section-overlay"></div>

            <div class="container d-flex justify-content-center align-items-center">
                <div class="row">

                    <div class="col-12 mt-auto mb-5 text-center">
                        <small>Prime Events Committee Presents</small>

                        <h1 class="text-white mb-5">Prime Outing 2025</h1>

                        <a class="btn custom-btn smoothscroll" href="#section_2">Let's explore</a>
                    </div>

                    <div class="col-lg-12 col-12 mt-auto d-flex flex-column flex-lg-row text-center">
                        <div class="date-wrap">
                            <h5 class="text-white">
                                <i class="custom-icon bi-clock me-2"></i>
                                3 - 5<sup>th</sup>, Oct 2025
                            </h5>
                        </div>

                        <div class="location-wrap mx-auto py-3 py-lg-0">
                            <h5 class="text-white">
                                <i class="custom-icon bi-geo-alt me-2"></i>
                                Punarnava Resort, Dehradun
                            </h5>
                        </div>

                        <div class="social-share">
                            <ul class="social-icon d-flex align-items-center justify-content-center">
                                <span class="text-white me-3">Share:</span>

                                <li class="social-icon-item">
                                    <a href="#" class="social-icon-link">
                                        <span class="bi-facebook"></span>
                                    </a>
                                </li>

                                <li class="social-icon-item">
                                    <a href="#" class="social-icon-link">
                                        <span class="bi-twitter"></span>
                                    </a>
                                </li>

                                <li class="social-icon-item">
                                    <a href="#" class="social-icon-link">
                                        <span class="bi-instagram"></span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="video-wrap">
                <video autoplay="" loop="" muted="" class="custom-video" poster="">
                    <source src="video/pexels-2022395.mp4" type="video/mp4">

                    Your browser does not support the video tag.
                </video>
            </div>
        </section>


        <section class="about-section section-padding" id="section_2">
            <div class="container">
                <div class="row">

                    <div class="col-lg-6 col-12 mb-4 mb-lg-0 d-flex align-items-center">
                        <div class="services-info">
                            <h2 class="text-white mb-4">üåÑ About Prime Outing 2025</h2>

                            <p class="text-white">Join us for an unforgettable team outing experience to the beautiful hills of Dehradun. Prime Outing 2025 is designed to strengthen team bonds, create lasting memories, and provide the perfect break from work routine.</p>

                            <h6 class="text-white mt-4">ü§ùTeam Building & Fun Galore</h6>

                           <p class="text-white">From thrilling team challenges üß© to hilarious group games üéØ, every moment is designed to spark joy and build stronger connections. Expect high-energy activities, lots of cheers, and memories that‚Äôll last a lifetime! ü•≥</p>

                            <h6 class="text-white mt-4">üé∂ DJ Night & Magical Vibes</h6>

                            <p class="text-white">As the sun sets üåÖ, the party begins! Groove to the beats of our DJ üéß, dance under the stars ‚ú®, and soak in the magic of ‚ÄúTaaron ki chaanv‚Äù üåå. It‚Äôs your night to shine, laugh, and let loose! üíÉüï∫</p>
                        </div>
                    </div>

                    <div class="col-lg-6 col-12">
                        <div class="about-text-wrap">
                            <img src="images/pexels-alexander-suhorucov-6457579.jpg" class="about-image img-fluid">
                        </div>
                    </div>

                </div>
            </div>
        </section>


        <!-- Gallery Section -->
        <section class="gallery-section section-padding" id="section_3">
            <div class="container gallery-container">
                <div class="row">
                    <div class="col-12">
                        <h2 class="gallery-title">Memory Lane</h2>
                        <p class="gallery-subtitle">Team Bonding Experiences & Cherished Moments</p>
                        
                        <div class="album-wrapper" id="albumWrapper">
                            <!-- Closed Album -->
                            <div class="closed-album" id="closedAlbum">
                                <div class="album-cover">
                                    <div class="album-cover-content">
                                        <h3 class="album-title">Prime Outing 2024</h3>
                                        <p class="album-subtitle">Team Photo Album</p>
                                        <div class="click-to-open">
                                            <i class="bi-hand-index"></i>
                                            <span>Click to Open Album</span>
                                        </div>
                                    </div>
                                    <div class="album-spine"></div>
                                </div>
                            </div>
                            
                            <!-- Opened Flipbook Album -->
                            <div class="flipbook-album" id="flipbookAlbum" style="display: none;">
                                <div class="book-container">
                                    <!-- Left side of open book -->
                                    <div class="book-left-page" id="leftPage">
                                        <div class="page-content" id="leftPageContent">
                                            <!-- Content will be dynamically loaded -->
                                        </div>
                                    </div>
                                    
                                    <!-- Right side of open book -->
                                    <div class="book-right-page" id="rightPage">
                                        <div class="page-content" id="rightPageContent">
                                            <!-- Content will be dynamically loaded -->
                                        </div>
                                    </div>
                                    
                                    <!-- Book binding in the middle -->
                                    <div class="book-binding"></div>
                                </div>
                                
                                <!-- Navigation controls -->
                                <div class="book-controls">
                                    <button class="book-nav-btn" id="prevPageBtn" onclick="previousPage()">
                                        <i class="bi-chevron-left"></i> Previous
                                    </button>
                                    <span class="page-counter">
                                        Page <span id="currentPageNum">1</span> of <span id="totalPageNum">12</span>
                                    </span>
                                    <button class="book-nav-btn" id="nextPageBtn" onclick="nextPage()">
                                        Next <i class="bi-chevron-right"></i>
                                    </button>
                                    <button class="book-nav-btn close-book-btn" onclick="closeBook()">
                                        <i class="bi-x-lg"></i> Close Book
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <section class="location-section section-padding" id="section_4">
            <div class="container">
                <div class="row justify-content-center">

                    <div class="col-12 text-center">
                        <h2 class="mb-4">Know the Location</h2>
                    </div>

                    <div class="col-lg-6 col-12">
                        <div class="location-info">
                            <h4 class="text-dark mb-3">Punarnava Resort & Spa</h4>
                            <p class="text-dark mb-3">
                                <i class="bi-geo-alt custom-icon me-2"></i>
                                Dehradun, Uttarakhand
                            </p>
                            
                            <div class="location-features">
                                <div class="feature-item d-flex mb-3">
                                    <i class="bi-house custom-icon me-3"></i>
                                    <div>
                                        <h6 class="text-dark mb-1">Comfortable Accommodation</h6>
                                        <p class="text-dark mb-0">Well-appointed rooms with modern amenities</p>
                                    </div>
                                </div>
                                
                                <div class="feature-item d-flex mb-3">
                                    <i class="bi-water custom-icon me-3"></i>
                                    <div>
                                        <h6 class="text-dark mb-1">Swimming Pool</h6>
                                        <p class="text-dark mb-0">Relax and unwind in our beautiful pool</p>
                                    </div>
                                </div>
                                
                                <div class="feature-item d-flex mb-3">
                                    <i class="bi-tree custom-icon me-3"></i>
                                    <div>
                                        <h6 class="text-dark mb-1">Natural Beauty</h6>
                                        <p class="text-dark mb-0">Surrounded by scenic hills and greenery</p>
                                    </div>
                                </div>
                                
                                <div class="feature-item d-flex mb-3">
                                    <i class="bi-utensils custom-icon me-3"></i>
                                    <div>
                                        <h6 class="text-dark mb-1">Great Dining</h6>
                                        <p class="text-dark mb-0">Delicious food and dining experience</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6 col-12">
                        <div class="location-image-wrap">
                            <img src="images/pexels-alexander-suhorucov-6457578.jpg" class="location-image img-fluid rounded">
                            
                            <div class="location-highlight">
                                <div class="highlight-content">
                                    <h5 class="text-dark mb-2">Journey Details</h5>
                                    <p class="text-dark mb-1">
                                        <i class="bi-clock custom-icon me-2"></i>
                                        8 hours comfortable bus travel
                                    </p>
                                    <p class="text-dark mb-1">
                                        <i class="bi-pin-map custom-icon me-2"></i>
                                        From Stellar IT Park to Resort
                                    </p>
                                    <p class="text-dark mb-0">
                                        <i class="bi-star custom-icon me-2"></i>
                                        250 km scenic route
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>


        <section class="schedule-section section-padding" id="section_5">
            <div class="container">
                <div class="row">

                    <div class="col-12 text-center">
                        <h2 class="text-white mb-4">Event Schedule</h2>

                        <div class="table-responsive">
                            <table class="schedule-table table table-dark">
                                <thead>
                                    <tr>
                                        <th scope="col">Time</th>
                                        <th scope="col">October 3 (Friday)</th>
                                        <th scope="col">October 4 (Saturday)</th>
                                        <th scope="col">October 5 (Sunday)</th>
                                    </tr>
                                </thead>

                                <tbody>
                                    <tr>
                                        <th scope="row">Morning</th>
                                        <td style="background-color: #191818">
                                            <h3>Bagpacking</h3>
                                            <p class="mb-2">Day Time</p >
                                            <p>Home</p>
                                        </td>
                                        <td>
                                            <h3>Breakfast & Activities</h3>
                                            <p class="mb-2">8:00 AM - 1:30 PM</p>
                                            <p>Team Building</p>
                                        </td>
                                        <td>
                                            <h3>Final Breakfast</h3>
                                            <p class="mb-2">7:30 - 9:30 AM</p>
                                            <p>Check-out & Photos</p>
                                        </td>
                                    </tr>

                                    <tr>
                                        <th scope="row">Evening</th>
                                        <td class="table-background-image-wrap pop-background-image">
                                            <h3>Bus Journey</h3>
                                            <p class="mb-2">10:00 PM Onwards </p>
                                            <p>Stellar IT Park</p>
                                            <div class="section-overlay"></div>
                                        </td>
                                        <td class="table-background-image-wrap rock-background-image">
                                            <h3>DJ Night</h3>
                                            <p class="mb-2">7:30 - 10:00 PM</p>
                                            <p>Dance & Entertainment</p>
                                            <div class="section-overlay"></div>
                                        </td>
                                        <td>
                                            <h3>Return Journey</h3>
                                            <p class="mb-2">3:00 - 4:30 PM</p>
                                            <p>Lunch & Travel</p>
                                        </td>
                                    </tr>

                                    <tr>
                                        <th scope="row">Night</th>
                                        <td>
                                            <h3>üçøSnacking & üöªFreshen-Up</h3>
                                            <p class="mb-2">12:00 AM</p>
                                            <p>On the Way to Dehradun</p>
                                        </td>
                                        <td class="table-background-image-wrap country-background-image">
                                            <h3>Stargazing</h3>
                                            <p class="mb-2">11:00 PM+</p>
                                            <p>Taaron ki chaanv</p>
                                            <div class="section-overlay"></div>
                                        </td>
                                        <td>
                                            <h3>Back Home</h3>
                                            <p class="mb-2">7:00 PM</p>
                                            <p>Arrival at Stellar IT Park</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>





        <section class="contact-section section-padding" id="section_6">
            <div class="container">
                <div class="row">

                    <div class="col-lg-8 col-12 mx-auto">
                        <h2 class="text-center mb-4">Contact Information</h2>
                        
                        <div class="contact-info text-center">
                            <div class="contact-item mb-4">
                                <i class="bi-envelope custom-icon me-3"></i>
                                <h5 class="d-inline">Email Us</h5>
                                <p class="mt-2">PrimeEventCommittee@gmail.com</p>
                            </div>
                            
                            <div class="contact-item mb-4">
                                <i class="bi-calendar custom-icon me-3"></i>
                                <h5 class="d-inline">Event Dates</h5>
                                <p class="mt-2">October 3-5, 2025</p>
                            </div>
                            
                            <div class="contact-item mb-4">
                                <i class="bi-geo-alt custom-icon me-3"></i>
                                <h5 class="d-inline">Destination</h5>
                                <p class="mt-2">Punarnava Resort & Spa, Dehradun</p>
                            </div>
                            
                            <div class="contact-item mb-4">
                                <i class="bi-clock custom-icon me-3"></i>
                                <h5 class="d-inline">T-Shirt Collection</h5>
                                <p class="mt-2">October 3, 8:00-9:00 PM at Stellar IT Park</p>
                            </div>
                            
                            <div class="mt-5">
                                <h4 class="mb-3">Need Help?</h4>
                                <p class="text-muted">Use our AI chatbot for instant answers to all your Prime Outing 2025 questions!</p>
                                <p class="text-muted">Click the chat button in the bottom-right corner.</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>
    </main>


    <footer class="site-footer">
        <div class="site-footer-top">
            <div class="container">
                <div class="row">

                    <div class="col-lg-6 col-12">
                        <h2 class="text-white mb-lg-0">Prime Outing 2025</h2>
                    </div>

                    <div class="col-lg-6 col-12 d-flex justify-content-lg-end align-items-center">
                        <ul class="social-icon d-flex justify-content-lg-end">
                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-twitter"></span>
                                </a>
                            </li>

                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-apple"></span>
                                </a>
                            </li>

                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-instagram"></span>
                                </a>
                            </li>

                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-youtube"></span>
                                </a>
                            </li>

                            <li class="social-icon-item">
                                <a href="#" class="social-icon-link">
                                    <span class="bi-pinterest"></span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">

                <div class="col-lg-6 col-12 mb-4 pb-2">
                    <h5 class="site-footer-title mb-3">Links</h5>

                    <ul class="site-footer-links">
                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">Home</a>
                        </li>

                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">About</a>
                        </li>

                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">Location</a>
                        </li>

                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">Schedule</a>
                        </li>

                        <li class="site-footer-link-item">
                            <a href="#" class="site-footer-link">Contact</a>
                        </li>
                    </ul>
                </div>

                <div class="col-lg-3 col-md-6 col-12 mb-4 mb-lg-0">
                    <h5 class="site-footer-title mb-3">Have a question?</h5>

                    <p class="text-white d-flex mb-1">
                        <a href="tel: 956-063-3662" class="site-footer-link">
                            956-063-3662
                        </a>
                    </p>

                    <p class="text-white d-flex">
                        <a href="mailto:primeeventscommittee@gmail.com" class="site-footer-link">
                            primeeventscommittee@gmail.com
                        </a>
                    </p>
                </div>

                <div class="col-lg-3 col-md-6 col-11 mb-4 mb-lg-0 mb-md-0">
                    <h5 class="site-footer-title mb-3">Location</h5>

                    <p class="text-white d-flex mt-3 mb-2">
                        Stellar IT Park, Noida</p>

                    <a class="link-fx-1 color-contrast-higher mt-3" href="#">
                        <span>Our Maps</span>
                        <svg class="icon" viewBox="0 0 32 32" aria-hidden="true">
                            <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="16" cy="16" r="15.5"></circle>
                                <line x1="10" y1="18" x2="16" y2="12"></line>
                                <line x1="16" y1="12" x2="22" y2="18"></line>
                            </g>
                        </svg>
                    </a>
                </div>
            </div>
        </div>

        <div class="site-footer-bottom">
            <div class="container">
                <div class="row">

                    <div class="col-lg-3 col-12 mt-5">
                        <p class="copyright-text">Copyright ¬© 2025 Prime Outing Committee</p>
                        <p class="copyright-text">Prime Events Committee - TSYS International</p>
                    </div>

                    <div class="col-lg-8 col-12 mt-lg-5">
                        <ul class="site-footer-links">
                            <li class="site-footer-link-item">
                                <a href="#" class="site-footer-link">Terms &amp; Conditions</a>
                            </li>

                            <li class="site-footer-link-item">
                                <a href="#" class="site-footer-link">Privacy Policy</a>
                            </li>

                            <li class="site-footer-link-item">
                                <a href="#" class="site-footer-link">Your Feedback</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!--

T e m p l a t e M o

-->

    <!-- JAVASCRIPT FILES -->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.sticky.js"></script>
    <script src="js/click-scroll.js"></script>
    <script src="js/custom.js"></script>
    
    <!-- Photo Album JavaScript -->
    <script>
        // Album pages data
        const albumPages = [
            {
                type: 'cover',
                title: 'Prime Outing 2024',
                subtitle: 'Team Photo Album',
                description: 'Last Year memories that will last a lifetime'
            },
            {   
                type: 'photo',
                image: 'images/gallery/Travel 1 POST 27 sep.jpg',
                title: 'Adventure Begins',
                description: 'The excitement and anticipation as we started our Prime Outing 2024 journey'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 2  POST 27 sep.jpg',
                title: 'Team Spirit',
                description: 'Our team showing amazing enthusiasm and energy'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 3 POST 27 sep.jpg',
                title: 'Journey Moments',
                description: 'Capturing precious moments during our travel experience'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 4 POST 27 sep.jpg',
                title: 'Group Bonding',
                description: 'Team members connecting and building lasting friendships'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 5 POST 27 sep.jpg',
                title: 'Team Together',
                description: 'Our amazing team bonding and creating unforgettable memories'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 6  POST 27 sep.jpg',
                title: 'Scenic Views',
                description: 'Beautiful landscapes and breathtaking views during our outing'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 7  POST 27 sep.jpg',
                title: 'Adventure Time',
                description: 'Exploring new places and enjoying adventurous activities'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 8 POST 27 sep.jpg',
                title: 'Team Activities',
                description: 'Engaging in fun team building exercises and games'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 9 POST 27 sep.jpg',
                title: 'Happy Moments',
                description: 'Joyful expressions and laughter filling the air'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 10  POST 27 sep.jpg',
                title: 'Scenic Moments',
                description: 'Capturing the beautiful landscapes and moments during our outing'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 11 POST 27 sep.jpg',
                title: 'Group Photos',
                description: 'Memorable group pictures with the entire team'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 12 POST 27 sep.jpg',
                title: 'Outdoor Fun',
                description: 'Enjoying outdoor activities in the beautiful natural setting'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 13 POST 27 sep.jpg',
                title: 'Team Collaboration',
                description: 'Working together and supporting each other during activities'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 14 POST 27 sep.jpg',
                title: 'Nature Exploration',
                description: 'Discovering and appreciating the natural beauty around us'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 15 POST 27 sep.jpg',
                title: 'Fun Activities',
                description: 'Enjoying team building activities and recreational fun'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 16 POST 27 sep.jpg',
                title: 'Candid Moments',
                description: 'Natural and spontaneous moments captured during the trip'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 17 POST 27 sep.jpg',
                title: 'Team Unity',
                description: 'Showing the strong bond and unity among team members'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 18 POST 27 sep.jpg',
                title: 'Adventure Continues',
                description: 'More exciting adventures and experiences throughout the day'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 20 POST 27 SEP(1).jpg',
                title: 'Special Moments',
                description: 'Unique and special moments that made the trip extraordinary'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 20 POST 27 sep.jpg',
                title: 'Memories Made',
                description: 'Precious moments that will be cherished forever by our team'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 21 POST 27 sep.jpg',
                title: 'Final Adventures',
                description: 'The concluding adventures of our amazing outing experience'
            },
            {
                type: 'photo',
                image: 'images/gallery/Travel 22 POST 27 sep.jpg',
                title: 'Journey\'s End',
                description: 'The perfect ending to our unforgettable Prime Outing 2024'
            }
        ];
            
        let currentPageIndex = 0;
        let isAnimating = false;
        
        // Generate page content
        function generatePageContent(page) {
            if (page.type === 'cover') {
                return `
                    <h2>${page.title}</h2>
                    <p>${page.subtitle}</p>
                    <div class="decorative-border"></div>
                    <p style="margin-top: 2rem; opacity: 0.8;">${page.description}</p>
                `;
            } else {
                return `
                    <img src="${page.image}" alt="${page.title}">
                    <h3>${page.title}</h3>
                    <p>${page.description}</p>
                `;
            }
        }
        
        // Update page content
        function updatePages() {
            const leftPageContent = document.getElementById('leftPageContent');
            const rightPageContent = document.getElementById('rightPageContent');
            const currentPageNum = document.getElementById('currentPageNum');
            const totalPageNum = document.getElementById('totalPageNum');
            const prevBtn = document.getElementById('prevPageBtn');
            const nextBtn = document.getElementById('nextPageBtn');
            
            if (!leftPageContent || !rightPageContent) return;
            
            // Update page counter
            currentPageNum.textContent = Math.floor(currentPageIndex / 2) + 1;
            totalPageNum.textContent = Math.ceil(albumPages.length / 2);
            
            // Update navigation buttons
            prevBtn.disabled = currentPageIndex === 0;
            nextBtn.disabled = currentPageIndex >= albumPages.length - 1;
            
            // Load left page
            if (currentPageIndex < albumPages.length) {
                leftPageContent.innerHTML = generatePageContent(albumPages[currentPageIndex]);
                leftPageContent.parentElement.className = albumPages[currentPageIndex].type === 'cover' ? 'book-left-page cover-page' : 'book-left-page';
            }
            
            // Load right page
            if (currentPageIndex + 1 < albumPages.length) {
                rightPageContent.innerHTML = generatePageContent(albumPages[currentPageIndex + 1]);
                rightPageContent.parentElement.className = albumPages[currentPageIndex + 1].type === 'cover' ? 'book-right-page cover-page' : 'book-right-page';
            } else {
                rightPageContent.innerHTML = '<p style="color: #999; text-align: center; margin-top: 200px;">Thank you for viewing!</p>';
                rightPageContent.parentElement.className = 'book-right-page';
            }
        }
        
        // Navigate pages
        function previousPage() {
            if (currentPageIndex > 0 && !isAnimating) {
                isAnimating = true;
                
                // Only flip the left page when going backward
                const leftPage = document.getElementById('leftPage');
                
                leftPage.classList.add('page-flip-backward');
                
                // Update content after animation starts
                setTimeout(() => {
                    currentPageIndex -= 2;
                    if (currentPageIndex < 0) currentPageIndex = 0;
                    updatePages();
                }, 400);
                
                // Remove animation classes after animation completes
                setTimeout(() => {
                    leftPage.classList.remove('page-flip-backward');
                    isAnimating = false;
                }, 800);
            }
        }
        
        function nextPage() {
            if (currentPageIndex < albumPages.length - 1 && !isAnimating) {
                isAnimating = true;
                
                // Only flip the right page when going forward
                const rightPage = document.getElementById('rightPage');
                
                rightPage.classList.add('page-flip-forward');
                
                // Update content after animation starts
                setTimeout(() => {
                    currentPageIndex += 2;
                    updatePages();
                }, 400);
                
                // Remove animation classes after animation completes
                setTimeout(() => {
                    rightPage.classList.remove('page-flip-forward');
                    isAnimating = false;
                }, 800);
            }
        }
        
        function closeBook() {
            const closedAlbum = document.getElementById('closedAlbum');
            const flipbookAlbum = document.getElementById('flipbookAlbum');
            
            flipbookAlbum.style.display = 'none';
            closedAlbum.style.display = 'flex';
        }
        
        // Define functions at top level first
        function openAlbum() {
            const closedAlbum = document.getElementById('closedAlbum');
            const flipbookAlbum = document.getElementById('flipbookAlbum');
            
            closedAlbum.style.display = 'none';
            flipbookAlbum.style.display = 'flex';
            
            // Initialize flipbook with cover page
            updatePages();
        }
        
        function closeAlbum() {
            const closedAlbum = document.getElementById('closedAlbum');
            const openedAlbum = document.getElementById('openedAlbum');
            
            openedAlbum.style.display = 'none';
            closedAlbum.style.display = 'flex';
            document.body.style.overflow = 'auto';
        }
        
        // Photo gallery data
        const photoGallery = [
            {
                src: 'images/gallery/team-group-photo.jpg',
                title: 'Our Amazing Team',
                description: 'Prime Outing 2025 - The complete team ready for an unforgettable journey'
            },
            {
                src: 'images/gallery/team-building-activity.jpg',
                title: 'Team Building Excellence',
                description: 'Engaging activities that brought us closer and strengthened our bonds'
            },
            {
                src: 'images/gallery/travel-bus-journey.jpg',
                title: 'Journey Begins',
                description: 'The exciting bus journey to Dehradun filled with laughter and anticipation'
            }
        ];
        
        let currentPhotoIndex = 0;
        
        // Show specific photo
        function showPhoto(index) {
            if (index < 0 || index >= photoGallery.length) return;
            
            currentPhotoIndex = index;
            const photo = photoGallery[index];
            
            // Update main photo
            document.getElementById('currentPhoto').src = photo.src;
            document.getElementById('currentPhoto').alt = photo.title;
            document.getElementById('photoTitle').textContent = photo.title;
            document.getElementById('photoDescription').textContent = photo.description;
            
            // Update photo counter
            document.getElementById('currentIndex').textContent = index + 1;
            document.getElementById('totalPhotos').textContent = photoGallery.length;
            
            // Update thumbnails
            const thumbnails = document.querySelectorAll('.thumbnail');
            thumbnails.forEach((thumb, i) => {
                thumb.classList.toggle('active', i === index);
            });
            
            // Update navigation buttons
            document.getElementById('prevPhotoBtn').disabled = index === 0;
            document.getElementById('nextPhotoBtn').disabled = index === photoGallery.length - 1;
        }
        
        // Navigate to previous photo
        function previousPhoto() {
            if (currentPhotoIndex > 0) {
                showPhoto(currentPhotoIndex - 1);
            }
        }
        
        // Navigate to next photo
        function nextPhoto() {
            if (currentPhotoIndex < photoGallery.length - 1) {
                showPhoto(currentPhotoIndex + 1);
            }
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            const openedAlbum = document.getElementById('openedAlbum');
            if (openedAlbum.style.display === 'flex') {
                switch(e.key) {
                    case 'ArrowLeft':
                        previousPhoto();
                        break;
                    case 'ArrowRight':
                        nextPhoto();
                        break;
                    case 'Escape':
                        closeAlbum();
                        break;
                }
            }
        });
        
        // Close album when clicking outside
        document.addEventListener('click', function(e) {
            const openedAlbum = document.getElementById('openedAlbum');
            const albumViewer = document.querySelector('.album-viewer');
            
            if (openedAlbum.style.display === 'flex' && !albumViewer.contains(e.target)) {
                closeAlbum();
            }
        });
        
        // Entrance animation for the closed album
        $(document).ready(function() {
            // Add click event listener as backup
            const closedAlbumElement = document.getElementById('closedAlbum');
            if (closedAlbumElement) {
                console.log('Adding event listener to album');
                
                // Add multiple event listeners to debug
                closedAlbumElement.addEventListener('click', function(e) {
                    console.log('Click event detected on album!');
                    e.preventDefault();
                    e.stopPropagation();
                    openAlbum();
                });
                
                closedAlbumElement.addEventListener('mouseenter', function() {
                    console.log('Mouse entered album area');
                    closedAlbumElement.style.border = '3px solid #F8CB2E';
                });
                
                closedAlbumElement.addEventListener('mouseleave', function() {
                    console.log('Mouse left album area');
                    closedAlbumElement.style.border = 'none';
                });
            } else {
                console.error('Could not find closedAlbum element');
            }
            
            // Add entrance animation when section comes into view
            function isElementInViewport(el) {
                const rect = el.getBoundingClientRect();
                return (
                    rect.top >= 0 &&
                    rect.left >= 0 &&
                    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                    rect.right <= (window.innerWidth || document.documentElement.clientWidth)
                );
            }
            
            // Animate album entrance
            $(window).scroll(function() {
                const $album = $("#closedAlbum")[0];
                if ($album && isElementInViewport($album) && !$album.classList.contains('animated')) {
                    $album.classList.add('animated');
                    $album.style.animation = 'slideUp 1s ease-out';
                }
            });
            
            // Add slideUp animation
            $('<style>').text(`
                @keyframes slideUp {
                    from {
                        opacity: 0;
                        transform: translateY(50px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
            `).appendTo('head');
        });
    </script>

    <!-- CHATBOT STYLES AND SCRIPTS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CHATBOT POPUP STYLES */
        .chatbot-widget {
            position: fixed;
            bottom: 110px;
            right: 20px;
            z-index: 1000;
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .chatbot-toggle {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #1a1a2e 100%);
            border: 3px solid #F8CB2E;
            color: #F8CB2E;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 8px 30px rgba(44, 62, 80, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        
        .chatbot-toggle::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .chatbot-toggle:hover::before {
            left: 100%;
        }
        
        .chatbot-toggle:hover {
            transform: scale(1.15) rotate(5deg);
            box-shadow: 0 12px 40px rgba(44, 62, 80, 0.6);
        }
        
        .chatbot-popup {
            position: fixed;
            bottom: 200px;      
            right: 20px;
            width: 400px;
            height: 480px;
            background: white;
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3), 0 0 0 1px rgba(102, 126, 234, 0.1);
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            z-index: 1001;
        }
        
        .chatbot-popup.active {
            display: flex;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .chatbot-header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #1a1a2e 100%);
            color: #F8CB2E;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }
        
        .chatbot-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 60"><defs><linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="white" stop-opacity="0.1"/><stop offset="100%" stop-color="white" stop-opacity="0"/></linearGradient></defs><circle cx="10" cy="10" r="2" fill="url(%23grad)"/><circle cx="50" cy="30" r="3" fill="url(%23grad)"/><circle cx="30" cy="50" r="2" fill="url(%23grad)"/></svg>') repeat;
            opacity: 0.3;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            z-index: 1;
        }
        
        .bot-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            position: relative;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
        
        .bot-avatar::after {
            content: '';
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 12px;
            height: 12px;
            background: #28a745;
            border: 2px solid white;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(40, 167, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
        }
        
        .header-text h3 {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        
        .status {
            font-size: 13px;
            opacity: 0.9;
            font-weight: 400;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .status::before {
            content: '‚óè';
            color: #28a745;
            animation: pulse 2s infinite;
        }
        
        .close-btn {
            background: rgba(248,203,46,0.2);
            border: none;
            color: #F8CB2E;
            font-size: 20px;
            cursor: pointer;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
        }
        
        .close-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }
        
        .chat-messages {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            position: relative;
        }
        
        .chat-messages::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="dots" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="rgba(102,126,234,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23dots)"/></svg>');
            pointer-events: none;
        }
        
        .message {
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            position: relative;
            z-index: 1;
            animation: messageSlide 0.3s ease;
        }
        
        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message.user-message {
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            border: 2px solid white;
        }
        
        .user-message .message-avatar {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        
        .message-content {
            background: white;
            padding: 15px 18px;
            border-radius: 20px;
            max-width: 280px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            font-size: 14px;
            line-height: 1.5;
            font-family: 'Inter', sans-serif;
            position: relative;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }
        
        .message-content::before {
            content: '';
            position: absolute;
            top: 15px;
            left: -8px;
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 8px solid white;
        }
        
        .user-message .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .user-message .message-content::before {
            left: auto;
            right: -8px;
            border-right: none;
            border-left: 8px solid #667eea;
        }
        
        .quick-questions {
            padding: 20px;
            background: white;
            border-top: 1px solid rgba(102, 126, 234, 0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            max-height: 140px;
            overflow-y: auto;
        }
        
        .quick-question {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid rgba(102, 126, 234, 0.1);
            border-radius: 25px;
            padding: 8px 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }
        
        .quick-question::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .quick-question:hover::before {
            left: 100%;
        }
        
        .quick-question:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }
        
        .chat-input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid rgba(102, 126, 234, 0.1);
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 25px;
            outline: none;
            font-size: 14px;
            resize: none;
            max-height: 80px;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
            background: rgba(248, 249, 250, 0.5);
        }
        
        .chat-input:focus {
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .send-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            font-size: 16px;
        }
        
        .send-btn:hover:not(:disabled) {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .send-btn:disabled {
            background: linear-gradient(135deg, #ccc 0%, #999 100%);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Mobile responsiveness */
        @media (max-width: 480px) {
            .chatbot-popup {
                width: 95vw;
                height: 75vh;
                right: 2.5vw;
                bottom: 190px;
                border-radius: 20px;
            }
            
            .chatbot-widget {
                bottom: 100px;
                right: 20px;
            }
            
            .chatbot-toggle {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }
        }
        
        /* Notification badge */
        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: linear-gradient(135deg, #ff4757 0%, #ff3742 100%);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: bounce 2s infinite;
            box-shadow: 0 4px 12px rgba(255, 71, 87, 0.4);
            border: 2px solid white;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }
        
        /* Scrollbar styling */
        .chat-messages::-webkit-scrollbar,
        .quick-questions::-webkit-scrollbar {
            width: 6px;
        }
        
        .chat-messages::-webkit-scrollbar-track,
        .quick-questions::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 3px;
        }
        
        .chat-messages::-webkit-scrollbar-thumb,
        .quick-questions::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 3px;
        }
        
        /* Typing indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 15px 18px;
            background: white;
            border-radius: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .typing-indicator span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #667eea;
            animation: typing 1.4s infinite ease-in-out both;
        }
        
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes typing {
            0%, 80%, 100% { 
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% { 
                transform: scale(1);
                opacity: 1;
            }
        }
    </style>

    <!-- Include XLSX library for Excel processing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Employee data storage with localStorage persistence
        let employeeData = [];
        let isOpen = false;
        let hasNewMessage = false;

        // Load employee data from localStorage on page load
        function loadEmployeeDataFromStorage() {
            try {
                const storedData = localStorage.getItem('primeOuting2025_employeeData');
                const storedTimestamp = localStorage.getItem('primeOuting2025_dataTimestamp');
                
                if (storedData && storedTimestamp) {
                    employeeData = JSON.parse(storedData);
                    const uploadDate = new Date(parseInt(storedTimestamp));
                    console.log(`Employee data loaded from storage: ${employeeData.length} records`);
                    console.log(`Data uploaded on: ${uploadDate.toLocaleString()}`);
                    
                    return true;
                }
                return false;
            } catch (error) {
                console.error('Error loading employee data from storage:', error);
                return false;
            }
        }

        // Save employee data to localStorage
        function saveEmployeeDataToStorage(data) {
            try {
                localStorage.setItem('primeOuting2025_employeeData', JSON.stringify(data));
                localStorage.setItem('primeOuting2025_dataTimestamp', Date.now().toString());
                console.log('Employee data saved to storage');
                return true;
            } catch (error) {
                console.error('Error saving employee data to storage:', error);
                return false;
            }
        }

        // Clear employee data from localStorage
        function clearEmployeeDataFromStorage() {
            try {
                localStorage.removeItem('primeOuting2025_employeeData');
                localStorage.removeItem('primeOuting2025_dataTimestamp');
                employeeData = [];
                console.log('Employee data cleared from storage');
                return true;
            } catch (error) {
                console.error('Error clearing employee data from storage:', error);
                return false;
            }
        }

        // Load PECData.xlsx automatically when page loads
        async function loadPECDataFile() {
            try {
                console.log('Attempting to load PECData.xlsx...');
                
                // Try multiple possible paths for the Excel file
                const possiblePaths = [
                    './PECData.xlsx',
                    '../PEC_v2.0/PECData.xlsx',
                    '../../PEC_v2.0/PECData.xlsx'
                ];
                
                let response = null;
                let workingPath = null;
                
                for (const path of possiblePaths) {
                    try {
                        response = await fetch(path);
                        if (response.ok) {
                            workingPath = path;
                            console.log(`Found PECData.xlsx at: ${path}`);
                            break;
                        }
                    } catch (error) {
                        console.log(`Failed to load from ${path}`);
                    }
                }
                
                if (!response || !response.ok) {
                    console.log('PECData.xlsx not found in any expected location');
                    return false;
                }
                
                const arrayBuffer = await response.arrayBuffer();
                const data = new Uint8Array(arrayBuffer);
                const workbook = XLSX.read(data, { type: 'array' });
                
                // Get the first worksheet
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                
                // Convert to JSON with headers
                const jsonData = XLSX.utils.sheet_to_json(worksheet);
                
                if (jsonData && jsonData.length > 0) {
                    // Update global employee data
                    employeeData = jsonData;
                    
                    // Save to storage for future use
                    saveEmployeeDataToStorage(jsonData);
                    
                    console.log(`‚úÖ PECData.xlsx loaded successfully: ${jsonData.length} records`);
                    console.log('Sample data:', jsonData.slice(0, 2));
                    
                    return true;
                } else {
                    console.log('‚ùå PECData.xlsx contains no valid data');
                    return false;
                }
                
            } catch (error) {
                console.error('Error loading PECData.xlsx:', error);
                return false;
            }
        }

        // Initialize with Excel data only
        async function initializeEmployeeData() {
            // First try to load from storage
            const hasStoredData = loadEmployeeDataFromStorage();
            
            if (hasStoredData) {
                console.log('Using stored employee data from PECData.xlsx');
                return;
            }
            
            // Try to load PECData.xlsx
            console.log('No stored data found, attempting to load PECData.xlsx...');
            const excelLoaded = await loadPECDataFile();
            
            if (!excelLoaded) {
                console.log('‚ùå PECData.xlsx could not be loaded. Employee lookup will not be available.');
                employeeData = [];
            }
        }

        // Load data when page loads
        window.addEventListener('DOMContentLoaded', function() {
            initializeEmployeeData();
        });

        // Employee lookup function for chatbot
        function lookupEmployee(employeeId) {
            console.log('=== LOOKUP EMPLOYEE FUNCTION CALLED ===');
            console.log('Received employeeId parameter:', employeeId);
            console.log('Employee data length:', employeeData ? employeeData.length : 'undefined');
            
            if (!employeeData || employeeData.length === 0) {
                console.log('No employee data available');
                return "‚ùå **Employee data not loaded yet.**\n\nPlease ensure PECData.xlsx is properly loaded. When hosted on GitHub, the file will load automatically.\n\n **Contact:** PrimeEventCommittee for assistance.";
            }
            
            // Clean the employee ID (remove spaces, convert to string, handle case)
            const cleanId = employeeId.toString().trim().toUpperCase();
            console.log('Searching for cleaned ID:', cleanId);
            
            // Search for employee - with detailed logging (case-insensitive)
            // Handle different possible column names for flexibility
            const employee = employeeData.find(emp => {
                // Try different possible column names for Employee ID
                const possibleIdFields = ['EmployeeID', 'Employee ID', 'ID', 'EmpID', 'id', 'employeeId'];
                let empId = '';
                
                for (const field of possibleIdFields) {
                    if (emp[field]) {
                        empId = emp[field].toString().trim().toUpperCase();
                        break;
                    }
                }
                
                console.log('Comparing:', empId, 'with', cleanId);
                return empId === cleanId;
            });
            
            console.log('Found employee:', employee);
            
            if (employee) {
                // Handle different possible column names for display
                const getName = () => {
                    return employee.Name || employee['Employee Name'] || employee.name || employee.employeeName || 'N/A';
                };
                
                const getBusNumber = () => {
                    return employee.BusNumber || employee['Bus Number'] || employee.Bus || employee.bus || employee.busNumber || 'N/A';
                };
                
                const getRoomNumber = () => {
                    return employee.RoomNumber || employee['Room Number'] || employee.Room || employee.room || employee.roomNumber || 'N/A';
                };
                
                const result = `üéØ **Employee Found!**\n\nüë§ **Name:** ${getName()}\nüöå **Bus Number:** ${getBusNumber()}\nüè† **Room Number:** ${getRoomNumber()}\n\nüìß **Questions?** PrimeEventCommittee\n\nüí° **Tip:** Save this info for easy reference!`;
                console.log('Returning result:', result);
                return result;
            } else {
                console.log('Employee not found');
                return `‚ùå **Employee ID "${employeeId}" not found in PECData.xlsx.**\n\nPlease verify your Employee ID and try again.\n\nüí° **Try different formats:**\n‚Ä¢ Your full employee ID number\n‚Ä¢ Without spaces or special characters\n‚Ä¢ Check for typos\n\nüìß **Need help?** PrimeEventCommittee@gmail.com`;
            }
        }

        // Function to load actual employee data (for administrators)
        window.loadActualEmployeeData = function(data) {
            if (Array.isArray(data) && data.length > 0) {
                employeeData = data;
                saveEmployeeDataToStorage(data);
                console.log(`‚úÖ Actual employee data loaded: ${data.length} records`);
                return `Successfully loaded ${data.length} employee records!`;
            } else {
                console.error('Invalid data format');
                return 'Please provide a valid array of employee data';
            }
        };

        // Function to manually retry Excel loading (useful for GitHub hosting)
        window.retryExcelLoad = async function() {
            console.log('Manually retrying Excel file load...');
            const success = await loadPECDataFile();
            if (success) {
                return `‚úÖ PECData.xlsx loaded successfully: ${employeeData.length} records`;
            } else {
                return '‚ùå Failed to load PECData.xlsx. Make sure the file is accessible.';
            }
        };

        // Function to check current data source
        window.checkDataSource = function() {
            if (!employeeData || employeeData.length === 0) {
                return 'No employee data loaded - PECData.xlsx not found';
            }
            
            return `Using data from PECData.xlsx (${employeeData.length} records)`;
        };

        // Function to clear employee data
        window.clearEmployeeData = function() {
            clearEmployeeDataFromStorage();
            employeeData = [];
            console.log('Employee data cleared - will need to reload PECData.xlsx');
            return 'Employee data cleared - will need to reload PECData.xlsx';
        };

        // Complete responses from working chatbot
        const basicResponses = {
            'hello': "Hello! Welcome to Prime Outing 2025 Chatbot. How can I help you today?",
            'hi': "Hi there! I'm here to assist you with any questions about Prime Outing 2025.",
            'help': "I can help you with Prime Outing 2025 information and employee bus/room details. Just ask!",
            'when': "Prime Outing 2025 is scheduled for **October 3-5, 2025** to Dehradun!\n\nüìÖ **Duration:** 2 Days, 1 Night\nüè® **Destination:** Punarnava Resort, Dehradun\nüìß **Questions?** PrimeEventCommittee@gmail.com",
            'where': "We're going to **Punarnava Resort, Dehradun** for our Prime Outing 2025!\n\nüèîÔ∏è **Location:** Dehradun, Uttarakhand\n‚è±Ô∏è **Journey Time:** About 8 hours from departure\nüöå **Mode:** Comfortable bus travel",
            'activities': "üéâ **Prime Outing 2025 Activities:**\n\nüéµ **DJ Night** - Dance the night away!\nüèÜ **Team Building Activities** - Fun group challenges\nüåü **Stargazing** - Under \"Taaron ki chaanv\"\nüì∏ **Group Photography** - Capture memories\nüèä **Swimming Pool** - Relax and unwind\nüçΩÔ∏è **Great Food** - Delicious meals\n\n*More surprises planned!* üéä",
            'itinerary': "**Complete Prime Outing 2025 Itinerary:**\n\n**üóìÔ∏è October 3rd (Friday):**\n‚Ä¢ 8:00-9:00 PM: T-shirt & baggage collection\n‚Ä¢ 9:30 PM: Lights, camera, Assemble! The cast is ready to roll!\n‚Ä¢ 10:00 PM: And the journey begins... cue the road trip playlist!\n‚Ä¢ 12:00 AM: Midnight munchies at the iconic dhaba ‚Äì full desi swag!\n\n**üóìÔ∏è October 4th (Saturday):**\n‚Ä¢ 1:00 AM: Back on the road ‚Äì doston ke saath, neend gayi bhaad mein!\n‚Ä¢ 4:00-4:30 AM: Quick pit stop ‚Äì freshen up for the next scene!\n‚Ä¢ 6:00 AM: Welcome to the set ‚Äì nature, peace, and pahadi vibes!\n‚Ä¢ 6:30 AM: Rooms mil gaye ‚Äì ab thoda rest, thoda selfie!\n‚Ä¢ 8:00-10:00 AM: Nashta Vaasta Kia jaye ‚Äì energy reload!\n‚Ä¢ 11:30 AM-1:00 PM: Adventure mode ON ‚Äì stunts, games, and full-on Team Bonding Vibes\n‚Ä¢ 1:30-3:00 PM: Khana Peena Ho jaye \n‚Ä¢ 5:00-6:00 PM: Chai pe charcha ‚Äì gossip, giggles, and garma garam snacks!\n‚Ä¢ 7:30-10:00 PM: Dance floor dhamaka ‚Äì lights, beats, and Bollywood thumkas\n‚Ä¢ 9:00-11:00 PM: Shaam-e-daawat ‚Äì Khaana Khilaana\n‚Ä¢ 11:00 PM+: Taaron ki chaanv me\n\n**üóìÔ∏è October 5th (Sunday):**\n‚Ä¢ 7:30-9:30 AM: Last meal together ‚Äì bittersweet bites and memories\n‚Ä¢ 9:45 AM: Pack up the memories ‚Äì but the story continues‚Ä¶\n‚Ä¢ 10:00 AM: Say cheese! Freeze the frame ‚Äì this one's going in the credits!\n‚Ä¢ 10:30 AM: Departure\n‚Ä¢ 3:00-4:30 PM: One last feast ‚Äì filmy farewell with foodie feels!\n‚Ä¢ 7:00 PM: Back to base ‚Äì hearts full, phones full, and souls recharged!",
            'schedule': "üìÖ **Prime Outing 2025 Schedule:**\n\n**October 3 (Friday):**\nüïò 8:00-9:00 PM: T-Shirt & Baggage Collection\nüöå 10:00 PM: Departure from Stellar IT Park\n\n**October 4 (Saturday):**\nüè® Full day at Punarnava Resort\nüéâ Activities, DJ Night & Fun!\n\n**October 5 (Sunday):**\nüïò 10:30 AM: Departure from resort\nüè† 7:00 PM: Return to Stellar IT Park",
            'resort': "üè® **Punarnava Resort & Spa, Dehradun**\n\nOur accommodation for Prime Outing 2025!\n\n‚ú® **Features:**\nüèä Swimming pool access\nüåø Beautiful natural surroundings\nüçΩÔ∏è Great dining facilities\nüè† Comfortable rooms\nüìß **Questions?** PrimeEventCommittee@gmail.com",
            'food': "üçΩÔ∏è **Food & Dining:**\n\nEnjoy delicious meals at Punarnava Resort!\n\nü•ò **Included:**\n‚Ä¢ Welcome refreshments\n‚Ä¢ Breakfast, Lunch & Dinner\n‚Ä¢ Evening snacks\n‚Ä¢ Special event meals\n\n*Variety of vegetarian and non-vegetarian options available!*",
            'departure': "üöå **Departure Details - October 3:**\n\nüïò **8:00-9:00 PM:** T-Shirt, Baggage & Attendance\nüïò **9:30 PM:** Assemble at Stellar IT Park\nüöå **10:00 PM:** Bus departure for Dehradun\nüçΩÔ∏è **12:00 AM:** Stop at SukhDev Dhaba\n\n‚è∞ **Please arrive on time!**",
            'return': "üè† **Return Details - October 5:**\n\nüïò **10:30 AM:** Departure from resort\nüçΩÔ∏è **3:00-4:30 PM:** Lunch break\nüè† **7:00 PM:** Arrival at Stellar IT Park\n\nüöå **Safe journey back home!**",
            'tshirt': "üëï **T-Shirt Collection:**\n\nCollect your custom Prime Outing 2025 T-shirts!\n\nüìÖ **When:** October 3, 8:00-9:00 PM\nüìç **Where:** Stellar IT Park\nüéØ **Don't forget** to collect during attendance marking!\n\n*Wear it with pride during the trip!* üéâ",
            'bring': "üéí **What to Bring for Prime Outing 2025:**\n\n**üëï Clothing:**\n‚Ä¢ Comfortable casual clothes (2-3 sets)\n‚Ä¢ Light jacket/sweater for evening\n‚Ä¢ Sleepwear and undergarments\n‚Ä¢ Extra pair of shoes/slippers\n\n**üß¥ Personal Items:**\n‚Ä¢ Toiletries (toothbrush, toothpaste, etc.)\n‚Ä¢ Personal medications\n‚Ä¢ Phone charger and power bank\n‚Ä¢ Camera for memories\n\n**üìã Documents:**\n‚Ä¢ Valid ID proof\n‚Ä¢ Any medical prescriptions\n\n**üí° Optional:**\n‚Ä¢ Sunglasses and sunscreen\n‚Ä¢ Small backpack for day activities\n‚Ä¢ Snacks for the journey\n\n*Pack light and enjoy the trip!* üåü",
            'packing': "üéí **Packing Guide for Prime Outing 2025:**\n\n**üëï Clothing Essentials:**\n‚Ä¢ 2-3 comfortable outfits\n‚Ä¢ Light jacket for cool evenings\n‚Ä¢ Comfortable walking shoes\n‚Ä¢ Flip-flops/slippers for resort\n\n**üß¥ Personal Care:**\n‚Ä¢ Toiletries and personal hygiene items\n‚Ä¢ Any personal medications\n‚Ä¢ Hand sanitizer\n\n**üì± Electronics:**\n‚Ä¢ Phone charger (mandatory!)\n‚Ä¢ Power bank for long day\n‚Ä¢ Camera/phone for photos\n\n**üìÑ Important:**\n‚Ä¢ Valid photo ID\n‚Ä¢ Emergency contact details\n\n**üíº Travel Tips:**\n‚Ä¢ Pack in a small bag/backpack\n‚Ä¢ Keep essentials in carry-on\n‚Ä¢ Don't overpack - it's only 2 days!\n\n*Travel light, create memories!* ‚ú®",
            'dj': "üéµ **DJ Night - Prime Outing 2025:**\n\n*Get ready to dance the night away!*\n\nüïò **When:** October 4 evening (Saturday)\nüìç **Where:** Punarnava Resort party area\nüé∂ **Music:** Latest hits, Bollywood, and your favorites\nüíÉ **Dress:** Comfortable party wear\n\n**üéâ What to Expect:**\n‚Ä¢ Professional DJ with great sound system\n‚Ä¢ Dance floor with lighting effects\n‚Ä¢ Fun group activities and games\n‚Ä¢ Refreshments and snacks\n‚Ä¢ Photo opportunities\n\n**üí° Tips:**\n‚Ä¢ Wear comfortable dancing shoes\n‚Ä¢ Bring your energy and enthusiasm!\n‚Ä¢ Request your favorite songs\n\n*Let's make it a night to remember!* ‚ú®",
            'stargazing': "üåü **Stargazing - \"Taaron ki chaanv\":**\n\n*Experience the magic of the night sky!*\n\nüïò **When:** October 4 late evening (after DJ session)\nüìç **Where:** Open area at Punarnava Resort\nüåå **Experience:** Peaceful stargazing session\n\n**‚ú® What to Expect:**\n‚Ä¢ Clear mountain sky views\n‚Ä¢ Relaxing atmosphere\n‚Ä¢ Perfect for photos\n‚Ä¢ Quiet time with colleagues\n‚Ä¢ Beautiful Dehradun night views\n\n**üí° Tips:**\n‚Ä¢ Bring a light jacket (gets cool at night)\n‚Ä¢ Perfect time for group photos\n‚Ä¢ Enjoy the peaceful mountain air\n\n*Under the canopy of stars!* üå†",
            'swimming': "üèä **Swimming Pool - Punarnava Resort:**\n\n*Relax and unwind in style!*\n\nüïò **Available:** Throughout your stay\nüìç **Where:** Resort swimming pool area\nüåä **Type:** Clean, well-maintained pool\n\n**üèä‚Äç‚ôÄÔ∏è What to Expect:**\n‚Ä¢ Refreshing pool water\n‚Ä¢ Pool area seating\n‚Ä¢ Great for relaxation\n‚Ä¢ Perfect for group photos\n‚Ä¢ Safe and supervised area\n\n**üí° What to Bring:**\n‚Ä¢ Swimming costume/swim wear\n‚Ä¢ Towel (or use resort towels)\n‚Ä¢ Flip-flops for pool area\n‚Ä¢ Waterproof phone case for photos\n\n**‚è∞ Pool Hours:**\n‚Ä¢ Check with resort for specific timings\n‚Ä¢ Usually available during day hours\n\n*Dive into fun!* üí¶",
            'photography': "üì∏ **Group Photography Session:**\n\n*Capture memories that last forever!*\n\nüïò **When:** October 4 (multiple sessions)\nüìç **Where:** Beautiful spots around Punarnava Resort\nüì∑ **Style:** Professional group photos\n\n**üì∏ What to Expect:**\n‚Ä¢ Professional photographer\n‚Ä¢ Multiple group combinations\n‚Ä¢ Beautiful resort backdrop\n‚Ä¢ Individual and team photos\n‚Ä¢ Candid moments capture\n\n**üí° Photo Tips:**\n‚Ä¢ Wear your Prime Outing 2025 T-shirt\n‚Ä¢ Coordinate colors for group shots\n‚Ä¢ Bring props if you want\n‚Ä¢ Smile and have fun!\n\n**üì± Sharing:**\n‚Ä¢ Photos will be shared with everyone\n‚Ä¢ Perfect for social media\n‚Ä¢ Great for office memories\n\n*Say cheese and create memories!* üì∑‚ú®",
            'team': "üèÜ **Team Building Activities:**\n\n*Strengthen bonds and have fun together!*\n\nüïò **When:** October 4 (multiple sessions)\nüìç **Where:** Resort activity areas\nüë• **Format:** Interactive group activities\n\n**üéØ Activities Include:**\n‚Ä¢ Fun team challenges\n‚Ä¢ Problem-solving games\n‚Ä¢ Communication exercises\n‚Ä¢ Trust-building activities\n‚Ä¢ Competitive fun games\n\n**üèÖ What to Expect:**\n‚Ä¢ Prizes for winning teams\n‚Ä¢ Lots of laughter and fun\n‚Ä¢ New friendships\n‚Ä¢ Team spirit building\n‚Ä¢ Memorable experiences\n\n**üí° Tips:**\n‚Ä¢ Wear comfortable clothes\n‚Ä¢ Participate enthusiastically\n‚Ä¢ Support your teammates\n‚Ä¢ Have a positive attitude\n\n*Together we achieve more!* ü§ù",
            'contact': "üìß **Contact Information:**\n\nFor any questions about Prime Outing 2025:\n\n‚úâÔ∏è **Email:** PrimeEventCommittee@gmail.com\n\n*We're here to help make your trip amazing!* üåü",
            'important reminders': "‚ö†Ô∏è **Important Reminders - Prime Outing 2025:**\n\n**üìÖ BEFORE DEPARTURE (Oct 3):**\nüïò **8:00-9:00 PM** - T-Shirt & Baggage Collection at Stellar IT Park\nüïò **9:30 PM** - Assembly time (Don't be late!)\nüöå **10:00 PM** - Bus departure (Be punctual!)\n\n**üéí MUST BRING:**\nüìÑ Valid photo ID (Mandatory!)\nüîå Phone charger and power bank\nüíä Personal medications\nüëï Comfortable clothes for 2 days\n\n**üì± IMPORTANT:**\nüìß Save contact: PrimeEventCommittee@gmail.com\nüìû Keep emergency contacts handy\nüîã Keep your phone charged\n\n**üö® CRITICAL:**\n‚è∞ **October 3, 9:30 PM** - Last assembly call\nüöå Bus will leave sharp at **10:00 PM**\nüìç Meet at **Stellar IT Park parking**\n\n*Don't miss out on the fun!* üéâ",
            'things to remember': "üìù **Things to Remember - Prime Outing 2025:**\n\n**‚úÖ BEFORE LEAVING HOME:**\nüìÑ Check you have valid photo ID\nüîå Pack phone charger & power bank (essential!)\nüíä Bring personal medicines\nüß≥ Pack light - only 2 days!\n‚òî Check weather forecast\n\n**‚úÖ DEPARTURE DAY (Oct 3):**\n‚è∞ Reach Stellar IT Park by 9:30 PM\nüëï Collect your T-shirt (8-9 PM)\nüì± Keep phone charged & contacts saved\nüöå Be ready for 10:00 PM departure\n\n**‚úÖ DURING THE TRIP:**\nüèä Bring swimwear for pool activities\nüì∏ Keep camera/phone ready for photos\nüíÉ Comfortable shoes for DJ night\nüåü Light jacket for stargazing\nü§ù Participate in all activities!\n\n**‚úÖ SAFETY FIRST:**\nüìû Save emergency contacts\nüè• Inform about medical conditions\nüíß Stay hydrated throughout\nüë• Stay with the group\n\n*Have an amazing time!* üéâ‚ú®",
            'not going': "üòî **Sorry you're missing the fun, better luck next time!**\n\nWe'll definitely miss having you on this amazing trip to Dehradun. There will be more events in the future, so stay tuned!\n\nüìß **Stay connected:** PrimeEventCommittee@gmail.com for future events\n\n*Hope to see you at the next adventure!* üåü",
            'default': "I'm here to help with Prime Outing 2025 questions! You can ask about:\n\nüéâ **Activities** - What's planned for the trip\nüìÖ **Schedule** - Detailed itinerary\nüè® **Resort** - Accommodation details\nüöå **Transport** - Departure/return times\nüéí **What to bring** - Packing checklist\nüéØ **Employee ID lookup** - Your bus & room info\n\nJust ask away! üòä"
        };

        // MAIN SEND MESSAGE FUNCTION - Direct copy from working chatbot
        function sendMessage() {
            console.log('=== SEND MESSAGE CALLED ===');
            
            const userInput = document.getElementById('userInput');
            const message = userInput.value.trim();
            
            if (message === '') {
                console.log('Empty message, returning');
                return;
            }
            
            console.log('Processing message:', message);
            
            // Add user message to chat
            addMessage(message, 'user');
            
            // Clear input and reset height
            userInput.value = '';
            userInput.style.height = 'auto';
            
            // Disable send button
            const sendBtn = document.getElementById('sendButton');
            if (sendBtn) sendBtn.disabled = true;
            
            // Show typing indicator
            showTypingIndicator();
            
            // Process message and generate response
            setTimeout(() => {
                hideTypingIndicator();
                
                console.log('=== PRIORITY RESPONSE GENERATION ===');
                
                let response;
                const messageText = message.toLowerCase();
                console.log('Analyzing message:', messageText);
                
                // PRIORITY 1: T-shirt queries (HIGHEST PRIORITY)
                if (messageText.indexOf('shirt') !== -1 || messageText.indexOf('collection') !== -1) {
                    console.log('>>> T-SHIRT QUERY DETECTED <<<');
                    response = basicResponses.tshirt;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 2: Greeting queries
                if (messageText === 'hello' || messageText === 'hi' || messageText === 'hii' || 
                    messageText === 'hey' || messageText.indexOf('hello') !== -1) {
                    console.log('>>> GREETING QUERY DETECTED <<<');
                    response = basicResponses.hello;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 3: Where are we staying
                if (messageText.indexOf('where') !== -1 && (messageText.indexOf('stay') !== -1 || 
                    messageText.indexOf('accommodation') !== -1 || messageText.indexOf('hotel') !== -1 || 
                    messageText.indexOf('resort') !== -1)) {
                    console.log('>>> ACCOMMODATION QUERY DETECTED <<<');
                    response = basicResponses.resort;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 4: Activities
                if (messageText.indexOf('activity') !== -1 || messageText.indexOf('activities') !== -1 || 
                    messageText.indexOf('fun') !== -1 || messageText.indexOf('games') !== -1 ||
                    messageText.indexOf('planned') !== -1) {
                    console.log('>>> ACTIVITIES QUERY DETECTED <<<');
                    response = basicResponses.activities;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 5: Schedule/Itinerary
                if (messageText.indexOf('schedule') !== -1 || messageText.indexOf('itinerary') !== -1 ||
                    messageText.indexOf('complete') !== -1 || messageText.indexOf('timing') !== -1) {
                    console.log('>>> SCHEDULE QUERY DETECTED <<<');
                    response = basicResponses.itinerary;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 6: DJ Night
                if (messageText.indexOf('dj') !== -1 || messageText.indexOf('dance') !== -1 || 
                    messageText.indexOf('music') !== -1 || messageText.indexOf('party') !== -1) {
                    console.log('>>> DJ NIGHT QUERY DETECTED <<<');
                    response = basicResponses.dj;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 7: When/Dates
                if (messageText.indexOf('when') !== -1 || messageText.indexOf('date') !== -1 ||
                    messageText.indexOf('time') !== -1) {
                    console.log('>>> DATE/TIME QUERY DETECTED <<<');
                    response = basicResponses.when;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 8: Food
                if (messageText.indexOf('food') !== -1 || messageText.indexOf('meal') !== -1 ||
                    messageText.indexOf('eat') !== -1 || messageText.indexOf('dining') !== -1) {
                    console.log('>>> FOOD QUERY DETECTED <<<');
                    response = basicResponses.food;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 9: Packing/What to bring
                if (messageText.indexOf('bring') !== -1 || messageText.indexOf('pack') !== -1 ||
                    messageText.indexOf('carry') !== -1 || messageText.indexOf('items') !== -1) {
                    console.log('>>> PACKING QUERY DETECTED <<<');
                    response = basicResponses.packing;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 10: Contact
                if (messageText.indexOf('contact') !== -1 || messageText.indexOf('email') !== -1 ||
                    messageText.indexOf('help') !== -1) {
                    console.log('>>> CONTACT QUERY DETECTED <<<');
                    response = basicResponses.contact;
                    addMessage(response, 'bot');
                    if (sendBtn) sendBtn.disabled = false;
                    return;
                }
                
                // PRIORITY 11: Employee ID and bus/room logic
                console.log('>>> CHECKING EMPLOYEE/BUS LOGIC <<<');
                
                // Check for employee ID patterns (including alphanumeric) - enhanced patterns
                const employeeIdPatterns = [
                    /employee\s*id\s*:?\s*([a-zA-Z0-9]+)/i,
                    /\bid\s*:?\s*([a-zA-Z0-9]+)/i,
                    /my\s*id\s*is\s*([a-zA-Z0-9]+)/i,
                    /my\s*employee\s*id\s*is\s*([a-zA-Z0-9]+)/i,
                    /emp\s*id\s*:?\s*([a-zA-Z0-9]+)/i,
                    /id\s*number\s*:?\s*([a-zA-Z0-9]+)/i,
                    /employee\s*number\s*:?\s*([a-zA-Z0-9]+)/i,
                    /^\s*([a-zA-Z0-9]{3,})\s*$/,  // Just an alphanumeric ID (minimum 3 characters)
                    /\b([a-zA-Z]{1,2}\d{3,}|\d{3,}[a-zA-Z]{1,2}|\d{4,})\b/  // Common ID patterns like A123, 12A, 1234
                ];
                
                const isBusRoomQuery = messageText.includes('bus') || messageText.includes('room') || 
                                     messageText.includes('transport') || messageText.includes('accommodation') ||
                                     messageText.includes('assignment') || messageText.includes('details');
                
                console.log('Is bus/room query:', isBusRoomQuery);
                
                // Try to find employee ID
                let foundEmployeeId = null;
                
                // Common words that should NOT be treated as Employee IDs
                const excludeWords = ['my', 'the', 'bus', 'room', 'get', 'show', 'find', 'need', 'want', 'info', 'information'];
                
                for (const pattern of employeeIdPatterns) {
                    const match = message.match(pattern);
                    if (match && match[1]) {
                        const potentialId = match[1].toLowerCase();
                        
                        // Skip if it's a common word or too short
                        if (!excludeWords.includes(potentialId) && potentialId.length >= 3) {
                            foundEmployeeId = match[1];
                            console.log('Found employee ID:', foundEmployeeId, 'with pattern:', pattern);
                            break;
                        }
                    }
                }
                
                // Employee lookup logic (for specific ID patterns or bus/room queries with valid IDs)
                if (foundEmployeeId && foundEmployeeId.length >= 3 && (isBusRoomQuery || /^\s*[a-zA-Z0-9]{3,}\s*$/.test(message.trim()))) {
                    console.log('=== PERFORMING EMPLOYEE LOOKUP ===');
                    response = lookupEmployee(foundEmployeeId);
                }
                // General bus/room request without ID
                else if (isBusRoomQuery && !foundEmployeeId) {
                    response = "üöå **Need your bus and room information?**\n\nPlease provide your Employee ID in one of these formats:\n‚Ä¢ 'My employee ID is 12345'\n‚Ä¢ 'ID 12345'\n‚Ä¢ 'Employee ID 12345'\n‚Ä¢ Or just type your ID number: '12345'\n\nI'll look up your bus number and room assignment! üè†";
                }
                // Use default response for unknown queries
                else {
                    console.log('Using default response');
                    response = basicResponses.default;
                }
                
                console.log('Final response:', response);
                addMessage(response, 'bot');
                
                // Re-enable send button
                if (sendBtn) sendBtn.disabled = false;
                
            }, 1000 + Math.random() * 1000); // Random delay between 1-2 seconds
        }

        function toggleChatbot() {
            const popup = document.getElementById('chatbotPopup');
            const toggleIcon = document.getElementById('toggleIcon');
            const badge = document.getElementById('notificationBadge');
            
            isOpen = !isOpen;
            
            if (isOpen) {
                popup.classList.add('active');
                toggleIcon.textContent = '√ó';
                badge.style.display = 'none';
                hasNewMessage = false;
                
                // Focus on input
                setTimeout(() => {
                    const input = document.getElementById('userInput');
                    if (input) input.focus();
                }, 300);
            } else {
                popup.classList.remove('active');
                toggleIcon.textContent = 'üí¨';
            }
        }

        function sendQuickQuestion(question) {
            const userInput = document.getElementById('userInput');
            if (question === 'My employee ID is ') {
                // For employee lookup, just set the placeholder and focus
                userInput.value = question;
                userInput.focus();
                // Position cursor at the end
                userInput.setSelectionRange(userInput.value.length, userInput.value.length);
            } else {
                userInput.value = question;
                sendMessage();
            }
        }

        function addMessage(message, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = sender === 'bot' ? 'ü§ñ' : 'üë§';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.innerHTML = message.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Show notification if chat is closed
            if (!isOpen && sender === 'bot') {
                hasNewMessage = true;
                const badge = document.getElementById('notificationBadge');
                if (badge) badge.style.display = 'flex';
            }
        }

        function showTypingIndicator() {
            const chatMessages = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message bot-message typing-indicator-message';
            typingDiv.id = 'typing-indicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = 'ü§ñ';
            
            const content = document.createElement('div');
            content.className = 'message-content typing-indicator';
            
            for (let i = 0; i < 3; i++) {
                const dot = document.createElement('span');
                content.appendChild(dot);
            }
            
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(content);
            
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Enter key functionality
        document.addEventListener('DOMContentLoaded', function() {
            const userInput = document.getElementById('userInput');
            if (userInput) {
                userInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessage();
                    }
                });
            }
        });

        // Auto-resize textarea
        function autoResize() {
            const textarea = document.getElementById('userInput');
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 100) + 'px';
        }

        // Initialize auto-resize
        document.addEventListener('DOMContentLoaded', function() {
            const userInput = document.getElementById('userInput');
            if (userInput) {
                userInput.addEventListener('input', autoResize);
            }
        });
    </script>

    <!-- CHATBOT WIDGET -->
    <div class="chatbot-widget">
        <button class="chatbot-toggle" onclick="toggleChatbot()">
            <span id="toggleIcon">üí¨</span>
            <div class="notification-badge" id="notificationBadge">!</div>
        </button>
        <div class="chatbot-popup" id="chatbotPopup">
            <div class="chatbot-header">
                <div class="header-content">
                    <div class="bot-avatar">ü§ñ</div>
                    <div class="header-text">
                        <h3>Prime Outing Assistant</h3>
                        <div class="status">Online & Ready to Help</div>
                    </div>
                </div>
                <button class="close-btn" onclick="toggleChatbot()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="message">
                    <div class="message-avatar">ü§ñ</div>
                    <div class="message-content">
                        <strong>Hello! üëã</strong><br>
                        I'm your <em>Prime Outing 2025 Assistant</em>. I can help with trip information, itinerary details, T-shirt collection, and answer any questions about our amazing Dehradun adventure!
                        <br><br>
                        <i class="fas fa-id-card" style="color: #667eea;"></i> <strong>Type your Employee ID</strong> to get your bus and room assignments!
                        <br><br>
                        <i class="fas fa-lightbulb" style="color: #667eea;"></i> <small><em>When hosted on GitHub, actual employee data loads from PECData.xlsx. For local testing, try sample IDs: N79226, 12345, A1234</em></small>
                    </div>
                </div>
            </div>
            <div class="quick-questions">
                <div class="quick-question" onclick="sendQuickQuestion('My bus information')">
                    <i class="fas fa-bus"></i> Get Bus Info
                </div>
                <div class="quick-question" onclick="sendQuickQuestion('When is the trip?')">
                    <i class="fas fa-calendar-alt"></i> Trip Dates
                </div>
                <div class="quick-question" onclick="sendQuickQuestion('Where are we staying?')">
                    <i class="fas fa-hotel"></i> Accommodation
                </div>
                <div class="quick-question" onclick="sendQuickQuestion('What activities are planned?')">
                    <i class="fas fa-gamepad"></i> Activities
                </div>
                <div class="quick-question" onclick="sendQuickQuestion('T-shirt collection details')">
                    <i class="fas fa-tshirt"></i> T-shirts
                </div>
                <div class="quick-question" onclick="sendQuickQuestion('Complete itinerary')">
                    <i class="fas fa-list-ul"></i> Itinerary
                </div>
                <div class="quick-question" onclick="sendQuickQuestion('What to bring?')">
                    <i class="fas fa-suitcase"></i> Packing
                </div>
                <div class="quick-question" onclick="sendQuickQuestion('DJ night details')">
                    <i class="fas fa-music"></i> DJ Night
                </div>
                <div class="quick-question" onclick="sendQuickQuestion('Contact information')">
                    <i class="fas fa-phone"></i> Contact
                </div>
            </div>
            <div class="chat-input-area">
                <textarea class="chat-input" id="userInput" placeholder="Type your message here..." rows="1"></textarea>
                <button class="send-btn" id="sendButton" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- PWA Simple Install Script -->
    <script src="simple-pwa.js"></script>

</body>
</html>
